<!DOCTYPE html>
<html>
<body style="text-align:center;font-family:sans-serif">
  <h1 id="type"></h1>
  <h2 id="text"></h2>
  <h2 id="cert">Сертицировано ООО "ДРУЖНЫЙ БЕЛЫЙ КОТ" ИНН 5406305323</h2>
  <details>
    <summary>Создать свой сертификат</summary>
    <div id="creator" style="width:40%;display:inline-block">
      <h2>Создать свой сертификат</h2>
      <form id="creator_form">
        <label for="name">Имя объекта: </label>
        <input type="text" id="name" name="name" required minlength="1" maxlength="20" />
        <fieldset>
          <legend>Тип:</legend>
          <select id="type_select" name="type_select" reqiured>
            <option id="general" value="general" selected required>Сертификот: Обычный</option>
            <br>
            <option id="doc" value="doc" required>Сертификот: Деловой печатный документ</option>
          </select>
        </fieldset>
        <button id="create_btn" form>Создать</button>
        <div id="qrout" style="display:none">
          <h2>QR код:</h2>
          <img id="qr">
        </div>
      </form>
    </div>
  </details>
  <style>
    details {
      border: 1px solid #aaa;
      border-radius: 4px;
      padding: 0.5em 0.5em 0;
    }
    summary {
      font-weight: bold;
      margin: -0.5em -0.5em 0;
      padding: 0.5em;
    }
    details[open] {
      padding: 0.5em;
    }
    details[open] summary {
      border-bottom: 1px solid #aaa;
      margin-bottom: 0.5em;
    }
  </style>
  <script>
  const urlParams = new URLSearchParams(window.location.search);
  const name = urlParams.get('n');
  const type = urlParams.get('t');
  console.log(name,type);
  const type_text = document.getElementById("type");
  const text_text = document.getElementById("text");
  const cert_text = document.getElementById("cert");
  const creator_form = document.getElementById("creator_form");
  const create_btn = document.getElementById("create_btn");
  const qr = document.getElementById("qr");
  const qrout = document.getElementById("qrout");
  create_btn.addEventListener("click", e => {
    if (!creator_form.reportValidity()) return;
    url = `https://howsmsmsuser.github.io/p.github.io/?n=${creator_form.elements["name"].value}&t=${creator_form.elements["type_select"].selectedIndex}`;
    qrurl = `http://qrcoder.ru/code/?${encodeURIComponent(url)}&2&1`;
    qrout.style.display = "block";
    qr.src = qrurl;
  })
  switch(type) {
    case '0':
      type_text.innerText = "Сертификот";
      text_text.innerText = `Объект ${name} сертифицирован`;
      break
    case '1':
      type_text.innerText = "Сертификот";
      text_text.innerText = `Объект ${name} утверждён как "Деловой печатный документ"`;
      break
    default:
      type_text.innerText = "Ошибка";
      cert_text.innerText = "";
      break
  }
  </script>
</body>
</html>
