<!DOCTYPE html>
<html>
<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&family=Rubik&display=swap" rel="stylesheet">
  <style>
    :root {
      --text: #11080e;
      --background: #f3e7ef;
      --primary: #49c572;
      --secondary: #e0d7dd;
      --accent: #d5632a;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --text: #f7eef4;
        --background: #180c14;
        --primary: #3ab663;
        --secondary: #281f25;
        --accent: #d5632a;
      }
    }
    body {
      font-family: 'Rubik';
      font-weight: 400;
    }
    h1, h2, h3, h4, h5 {
      font-family: 'Comfortaa';
      font-weight: 700;
    }
    html {font-size: 100%;} /* 16px */
    h1 {font-size: 3.366rem; /* 53.92px */}
    h2 {font-size: 2.525rem; /* 40.32px */}
    h3 {font-size: 1.894rem; /* 30.24px */}
    h4 {font-size: 1.421rem; /* 22.72px */}
    h5 {font-size: 1.066rem; /* 17.12px */}
    small {font-size: 0.600rem; /* 9.6px */}
    body {
      display: flex;
      flex-flow: column;
      align-items: center;
      text-align: center;
      color: var(--text);
      background-color: var(--background);
    }
    details {
      border-radius: 4px;
      background-color: var(--primary);
      color: var(--background);
      width: 75%;
    }
    summary {
      font-weight: bold;
      padding: 1rem;
      display: block;
      padding-left: 2.2rem;
      position: relative;
      cursor: pointer;
    }
    summary:before {
      content: '';
      border-width: .4rem;
      border-style: solid;
      border-color: transparent transparent transparent #fff;
      position: absolute;
      top: 1.3rem;
      left: 1rem;
      transform: rotate(0);
      transform-origin: .2rem 50%;
      transition: .25s transform ease;
    }
    details[open] > summary:before {
      transform: rotate(90deg);
    }
    details summary::-webkit-details-marker {
      display:none;
    }
    details[open] {
      padding: 0 0 1em;
    }
    input, button, select {
      border: 0;
      border-radius: 4px;
      margin: 3px;
    }
    .bigbtn {
      font-size: 2.525rem;
      padding: .3em;
      background-color: var(--primary);
      color: var(--background);
      transition: filter .5s;
    }
    .bigbtn:hover {
      filter: brightness(0.85);
    }
    #qr {
      width: 10em;
      image-rendering: crisp-edges;
    }
    #premium_ad {
      width: 75%;
      background-color: var(--accent);
      margin-top: 8vh;
      border-radius: 3px;
      color: var(--background);
    }
  </style>
</head>
<body>
  <h1 id="type"></h1>
  
  <h2 id="text"></h2>
  <p id="cert">Сертицировано ООО "ДРУЖНЫЙ БЕЛЫЙ КОТ" ИНН 5406305323</p>
  
  <details id="creator_folder">
    <summary>Создать свой сертификат</summary>
    <div id="creator" style="display:inline-block">
      <h3>Создать свой сертификат</h3>
      <form id="creator_form">
        <label for="name">Имя объекта: </label>
        <input type="text" id="name" name="name" required minlength="1" maxlength="20" />
        <br><br>
        <label for="type_select">Тип:</label>
        <select id="type_select" name="type_select" reqiured>
          <option id="general" value="general" selected required>Сертификот: Обычный</option>
          <option id="doc" value="doc" required>Сертификот: Деловой печатный документ</option>
        </select>
        <button id="create_btn" form>Создать</button>
        <div id="qrout" style="display:none">
          <h3>QR код:</h3>
          <img id="qr">
        </div>
      </form>
    </div>
  </details>
  <div id="premium_ad">
    <h1>Костя Премиум</h1>
    <h3>Создавайте сертификаты без ограничений!</h3>
    <p>Вы сможете создать свой уникальный сертификат!</p>
    <h4>Всего за <span id="premium_price">100000000</span>₽</h4>
    <label for="promocode">Промокод:</label>
    <input type="text" id="promocode" name="promocode" required minlength="1" maxlength="5" size="10" spellcheck="false" />
    <br>
    <button id="buy_premium">Купить</button>
  </div>
  <script>
  const urlParams = new URLSearchParams(window.location.search);
  const name = urlParams.get('n');
  const type = urlParams.get('t');
  console.log(name,type);
  const type_text = document.getElementById("type");
  const text_text = document.getElementById("text");
  const cert_text = document.getElementById("cert");
  const creator_form = document.getElementById("creator_form");
  const creator_folder = document.getElementById("creator_folder");
  const create_btn = document.getElementById("create_btn");
  const qr = document.getElementById("qr");
  const qrout = document.getElementById("qrout");
  const ad = document.getElementById("premium_ad");
  const promo = document.getElementById("promocode");
  const premiumprice = document.getElementById("premium_price");
  var hasPremium = localStorage.getItem("premium") === "kostya"
  if (hasPremium) ad.style.display = "none";
  create_btn.addEventListener("click", e => {
    if (!creator_form.reportValidity()) return;
    url = `https://howsmsmsuser.github.io/p.github.io/?n=${creator_form.elements["name"].value}&t=${creator_form.elements["type_select"].selectedIndex}`;
    qrurl = `https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(encodeURIComponent(url))}&size=300x300`;
    qrout.style.display = "block";
    qr.src = qrurl;
  })
  promo.addEventListener("input", e => {
    if (promo.value.toLowerCase() == "10МЯУ") {
      premiumprice.innerText = "0";
    } else {
      premiumprice.innerText = "100000000";
    }
  })
  document.getElementById("create_btn").addEventListener("click", e => {
    if (promo.value.toLowerCase() == "10МЯУ") {
      localStorage.setItem("premium", "kostya");
      hasPremium = true;
      ad.style.display = "none";
      alert("Вы купили Костя Премиум!");
    } else {
      alert("У вас таких денег нет.");
    }
  })
  switch(type) {
    case '0':
      type_text.innerText = "Сертификот";
      text_text.innerText = `Объект ${name} сертифицирован`;
      break
    case '1':
      type_text.innerText = "Сертификот";
      text_text.innerText = `Объект ${name} утверждён как "Деловой печатный документ"`;
      break
    case '2':
      type_text.innerText = "Сертифигав";
      text_text.innerText = `Объект ${name} сертифицирован как ${urlParams.get('c')}`;
      break
    case null:
      type_text.innerText = "";
      cert_text.innerText = "";
      creator_folder.open = true;
      break
    default:
      type_text.innerText = "Ошибка";
      cert_text.innerText = "";
      break
  }
  </script>
</body>
</html>
